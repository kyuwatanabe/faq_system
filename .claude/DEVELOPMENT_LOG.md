# 開発履歴

このファイルには、主要な開発作業の履歴を記録しています。

## 2025-10-08

### FAQ自動生成機能の改善
- **問題**: 資料に記載されていない内容がFAQとして生成される
- **対応**: プロンプトに「PDFに記載されている内容のみから生成」という制約を明示
- **ファイル**: `faq_system.py` (generate_faqs_from_document関数)

### FAQ生成履歴機能の追加
- **目的**: 同じFAQが繰り返し生成されることを防ぐ
- **実装**:
  - `_load_generation_history()`: 過去の生成履歴を読み込み
  - `_save_to_generation_history()`: 生成したFAQを履歴ファイルに保存
  - `faq_generation_history.csv`: 生成履歴を保存するファイル
- **効果**: 承認待ちを却下しても、同じFAQは再生成されない
- **ファイル**: `faq_system.py`

### バッチ削除機能の修正
- **問題**: 複数選択しても1件ずつしか削除されない
- **原因**: HTMLテンプレートでフォームがネストしていた + ブラウザキャッシュ
- **対応**:
  - 編集フォームをバッチ削除フォームの外に配置
  - フォーム構造を分離して、ネストを完全に解消
- **ファイル**: `templates/admin.html`
- **コミット**: `7a55963`

### .gitignoreの更新
- 以下を追加:
  - `faq_generation_history.csv` - 生成履歴（ローカル環境固有）
  - `unsatisfied_qa.csv` - 不満足Q&A記録（ローカル環境固有）

---

## 2025-10-02

### バッチ削除機能の初回修正
- フォームネストの問題を修正
- コミット: `26ca13b`

---

## 2025-10-01以前

### 統合バックアップ機能
- FAQ、承認待ちQ&A、不満足Q&AをZIPで一括エクスポート・インポート
- 専用ページ `/admin/backup` を追加

### 承認待ちFAQ機能
- 自動生成されたFAQを承認・却下できる機能
- 重複チェック機能（類似FAQを検出）
- 確認依頼フラグ（上司に確認が必要なFAQをマーク）

### FAQ自動生成機能（初期実装）
- PDFファイルからFAQを自動生成
- Claude API または モック機能で動作
- 承認待ちキューに追加される仕組み

### FAQ管理機能
- FAQ一覧表示
- FAQ追加・編集・削除
- カテゴリ管理

### FAQ検索機能
- ユーザーからの質問に対して最適なFAQを検索
- 文字列類似度 + キーワードスコアで精度向上
- 類似度が低い場合は確認を求める

---

## 今後の改善案

### 優先度: 高
- [ ] FAQ自動生成時のPDFテキスト抽出精度の向上
- [ ] 承認待ちFAQの一括承認・一括却下機能
- [ ] FAQ検索精度のさらなる向上

### 優先度: 中
- [ ] FAQのカテゴリ別フィルタリング機能
- [ ] FAQ使用頻度の記録・分析
- [ ] ユーザーからのフィードバック収集機能の強化

### 優先度: 低
- [ ] FAQのバージョン管理（変更履歴）
- [ ] 多言語対応
- [ ] ダークモード対応
